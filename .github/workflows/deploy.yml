    - name: Deploy code via SSM Run Command
      id: deploy_command
      run: |
        COMMANDS=$(cat << EOF
cd /var/www/html
git reset --hard
git clean -fd
git pull origin main
sudo chown -R www-data:www-data /var/www/html
sudo chmod -R 755 /var/www/html
EOF
)

        COMMAND_ID=$(aws ssm send-command \
          --instance-ids ${{ secrets.EC2_INSTANCE_ID }} \
          --document-name "AWS-RunShellScript" \
          --comment "Deploy from GitHub Actions" \
          --parameters commands="$COMMANDS" \
          --query "Command.CommandId" --output text)

        echo "Command ID: $COMMAND_ID"

        sleep 15

        aws ssm get-command-invocation \
          --command-id $COMMAND_ID \
          --instance-id ${{ secrets.EC2_INSTANCE_ID }}
